# æ­¥è¡Œå¯¼èˆªåŠŸèƒ½ - ä½¿ç”¨æŒ‡å—

## åŠŸèƒ½æ¦‚è¿°

ç°åœ¨ç”¨æˆ·å¯ä»¥åœ¨æ‰¾åˆ°é™„è¿‘ç›®çš„åœ°åï¼Œç‚¹å‡»å¯¼èˆªæŒ‰é’®å¯åŠ¨æ­¥è¡Œå¯¼èˆªåˆ°ç›®çš„åœ°ã€‚è¯¥åŠŸèƒ½ä¼šè‡ªåŠ¨æ‰“å¼€è®¾å¤‡çš„åŸç”Ÿåœ°å›¾åº”ç”¨ï¼ˆApple Maps æˆ– Google Mapsï¼‰ï¼Œæä¾›é€æ­¥å¯¼èˆªæŒ‡å¼•ã€‚

## åŠŸèƒ½æµç¨‹

1. **é€‰æ‹©æ„Ÿå—å’Œæ—¶é—´** - åœ¨ Break Tab ä¸­é€‰æ‹©ä½ çš„æ„Ÿå—çŠ¶æ€å’Œå¯ç”¨æ—¶é—´
2. **æŸ¥çœ‹å»ºè®®è®¡åˆ’** - ç³»ç»Ÿä¼šç”Ÿæˆä¸ªæ€§åŒ–çš„ä¼‘æ¯è®¡åˆ’
3. **é€‰æ‹©æ­¥è¡Œç›®çš„åœ°** - åœ¨è®¡åˆ’ä¸­æ‰¾åˆ°æ­¥è¡Œæ´»åŠ¨ï¼Œç‚¹å‡»"Navigate"æŒ‰é’®
4. **æ‰“å¼€åœ°å›¾ç•Œé¢** - æŸ¥çœ‹ä½ çš„å½“å‰ä½ç½®å’Œé™„è¿‘çš„ç›®çš„åœ°
5. **é€‰æ‹©ç›®çš„åœ°** - æ»šåŠ¨æµè§ˆå¹¶é€‰æ‹©ä½ æƒ³å»çš„åœ°ç‚¹
6. **å¼€å§‹å¯¼èˆª** - ç‚¹å‡»"Navigate"æŒ‰é’®å¯åŠ¨æ­¥è¡Œå¯¼èˆª

## ç”¨æˆ·ç•Œé¢è¯´æ˜

### åœ°å›¾æ¨¡æ€æ¡†ç»„ä»¶

- **é¡¶éƒ¨å¾½ç« **
  - ğŸ• é¢„è®¡æ­¥è¡Œæ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  - ğŸ“ è·ç¦»ï¼ˆç±³/å…¬é‡Œï¼‰

- **é™„è¿‘åœ°ç‚¹æ»šåŠ¨åˆ—è¡¨**
  - æ°´å¹³æ»šåŠ¨æŸ¥çœ‹é™„è¿‘çš„æ¨èåœ°ç‚¹
  - ç‚¹å‡»ä»»æ„åœ°ç‚¹èŠ¯ç‰‡å³å¯é€‰æ‹©è¯¥ç›®çš„åœ°
  - é€‰ä¸­çš„åœ°ç‚¹ä¼šé«˜äº®æ˜¾ç¤º

- **å¯¼èˆªæŒ‡å¼•æç¤º**
  - æœªå¯¼èˆªæ—¶ï¼šæ˜¾ç¤º"Tap the navigation button to start walking directions to [ç›®çš„åœ°åç§°]"
  - å¯¼èˆªä¸­ï¼šæ˜¾ç¤º"Opening navigation in your maps app..."

- **æ“ä½œæŒ‰é’®**
  - **Navigate æŒ‰é’®**ï¼šç‚¹å‡»å¯åŠ¨æ­¥è¡Œå¯¼èˆª
    - é»˜è®¤çŠ¶æ€ï¼šé’è‰²èƒŒæ™¯
    - æ¿€æ´»çŠ¶æ€ï¼šæ·±é’è‰²èƒŒæ™¯ï¼Œç™½è‰²å›¾æ ‡
    - ç¦ç”¨çŠ¶æ€ï¼šåŠé€æ˜
  - **Voice Chat æŒ‰é’®**ï¼šå¯åŠ¨è¯­éŸ³åŠ©æ‰‹åŠŸèƒ½

### è§†è§‰åé¦ˆ

- åœ°å›¾ä¸Šä¼šæ˜¾ç¤ºï¼š
  - ğŸ”µ ç”¨æˆ·å½“å‰ä½ç½®ï¼ˆè“è‰²åœ†ç‚¹ï¼‰
  - ğŸ“ é™„è¿‘ç›®çš„åœ°ï¼ˆåœ°å›¾æ ‡è®°ï¼‰
  - ğŸ“ˆ æ­¥è¡Œè·¯çº¿ï¼ˆè“è‰²æŠ˜çº¿ï¼‰- é€‰æ‹©ç›®çš„åœ°åè‡ªåŠ¨è®¡ç®—

## æŠ€æœ¯å®ç°

### å¹³å°æ”¯æŒ

#### iOS
- ä½¿ç”¨ Apple Maps åº”ç”¨è¿›è¡Œå¯¼èˆª
- URL Scheme: `maps://`
- æ”¯æŒçš„å¯¼èˆªæ¨¡å¼ï¼š
  - `w` - æ­¥è¡Œ (é»˜è®¤)
  - `d` - é©¾è½¦
  - `r` - å…¬å…±äº¤é€š

#### Android
- ä½¿ç”¨ Google Maps åº”ç”¨è¿›è¡Œå¯¼èˆª
- URL Scheme: `google.navigation:`
- æ”¯æŒçš„å¯¼èˆªæ¨¡å¼ï¼š
  - `walking` (é»˜è®¤)
  - `driving`
  - `transit`
  - `bicycling`

### å¯¼èˆªå·¥å…· API

ä½ç½®ï¼š`apps/mobile/src/utils/navigation.ts`

#### ä¸»è¦å‡½æ•°

```typescript
startNavigation(destination, options): Promise<boolean>
```

**å‚æ•°ï¼š**
- `destination`: NavigationDestination
  - `latitude`: number
  - `longitude`: number
  - `name?`: string (å¯é€‰)
  - `address?`: string (å¯é€‰)
- `options`: NavigationOptions (å¯é€‰)
  - `mode?`: 'walking' | 'driving' | 'transit' | 'bicycling' (é»˜è®¤: 'walking')
  - `origin?`: { latitude, longitude } (å¯é€‰)

**è¿”å›å€¼ï¼š**
- `Promise<boolean>` - æˆåŠŸæ‰“å¼€å¯¼èˆªè¿”å› true

#### è¾…åŠ©å‡½æ•°

```typescript
showLocation(destination): Promise<boolean>
```
åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºä½ç½®ï¼Œä¸å¯åŠ¨å¯¼èˆª

```typescript
isNavigationAvailable(): Promise<boolean>
```
æ£€æŸ¥è®¾å¤‡æ˜¯å¦æ”¯æŒå¯¼èˆªåŠŸèƒ½

## æµ‹è¯•æŒ‡å—

### iOS æµ‹è¯•ï¼ˆçœŸæœºæˆ–æ¨¡æ‹Ÿå™¨ï¼‰

1. **å¯åŠ¨åº”ç”¨**
   ```bash
   cd apps/mobile
   pnpm ios
   ```

2. **æµ‹è¯•æ­¥éª¤**
   - ç¡®ä¿ Apple Maps å·²å®‰è£…ï¼ˆiOS è‡ªå¸¦ï¼‰
   - å…è®¸ä½ç½®æƒé™
   - è¿›å…¥ Break Tab
   - é€‰æ‹©çŠ¶æ€å’Œæ—¶é—´åï¼Œç‚¹å‡» Start
   - é€‰æ‹©åŒ…å«æ­¥è¡Œæ´»åŠ¨çš„è®¡åˆ’
   - ç‚¹å‡» Navigate æŒ‰é’®æ‰“å¼€åœ°å›¾
   - é€‰æ‹©ä¸€ä¸ªç›®çš„åœ°
   - ç‚¹å‡» Navigate æŒ‰é’®
   - åº”è¯¥ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ° Apple Maps å¹¶å¼€å§‹å¯¼èˆª

3. **é¢„æœŸç»“æœ**
   - Apple Maps æ‰“å¼€
   - æ˜¾ç¤ºä»å½“å‰ä½ç½®åˆ°ç›®çš„åœ°çš„æ­¥è¡Œè·¯çº¿
   - å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„å¯¼èˆªæŒ‡å¼•

### Android æµ‹è¯•ï¼ˆçœŸæœºæˆ–æ¨¡æ‹Ÿå™¨ï¼‰

1. **å¯åŠ¨åº”ç”¨**
   ```bash
   cd apps/mobile
   pnpm android
   ```

2. **æµ‹è¯•æ­¥éª¤**
   - ç¡®ä¿ Google Maps å·²å®‰è£…
   - å…è®¸ä½ç½®æƒé™
   - è¿›å…¥ Break Tab
   - é€‰æ‹©çŠ¶æ€å’Œæ—¶é—´åï¼Œç‚¹å‡» Start
   - é€‰æ‹©åŒ…å«æ­¥è¡Œæ´»åŠ¨çš„è®¡åˆ’
   - ç‚¹å‡» Navigate æŒ‰é’®æ‰“å¼€åœ°å›¾
   - é€‰æ‹©ä¸€ä¸ªç›®çš„åœ°
   - ç‚¹å‡» Navigate æŒ‰é’®
   - åº”è¯¥ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ° Google Maps å¹¶å¼€å§‹å¯¼èˆª

3. **é¢„æœŸç»“æœ**
   - Google Maps æ‰“å¼€
   - æ˜¾ç¤ºä»å½“å‰ä½ç½®åˆ°ç›®çš„åœ°çš„æ­¥è¡Œè·¯çº¿
   - è¿›å…¥å¯¼èˆªæ¨¡å¼

### é”™è¯¯å¤„ç†æµ‹è¯•

1. **æ— åœ°å›¾åº”ç”¨**
   - åœ¨æ²¡æœ‰å®‰è£…åœ°å›¾åº”ç”¨çš„è®¾å¤‡ä¸Šæµ‹è¯•
   - åº”æ˜¾ç¤ºé”™è¯¯æç¤ºï¼š"Navigation Unavailable"

2. **æ— ç½‘ç»œè¿æ¥**
   - å…³é—­ç½‘ç»œè¿æ¥
   - å°è¯•å¼€å§‹å¯¼èˆª
   - åº”è¯¥èƒ½æ‰“å¼€åœ°å›¾åº”ç”¨ï¼Œä½†åœ°å›¾åŠ è½½å¯èƒ½å¤±è´¥ï¼ˆç”±åœ°å›¾åº”ç”¨å¤„ç†ï¼‰

3. **æƒé™è¢«æ‹’ç»**
   - æ‹’ç»ä½ç½®æƒé™
   - åº”ä½¿ç”¨åç«¯ API çš„é»˜è®¤ä½ç½®
   - å¯¼èˆªåŠŸèƒ½ä»åº”å¯ç”¨

## æ³¨æ„äº‹é¡¹

1. **ä½ç½®æƒé™**ï¼šé¦–æ¬¡ä½¿ç”¨éœ€è¦æˆäºˆä½ç½®æƒé™
2. **åœ°å›¾åº”ç”¨**ï¼šè®¾å¤‡å¿…é¡»å®‰è£…æ”¯æŒçš„åœ°å›¾åº”ç”¨ï¼ˆé€šå¸¸æ˜¯é¢„è£…çš„ï¼‰
3. **ç½‘ç»œè¿æ¥**ï¼šéœ€è¦ç½‘ç»œè¿æ¥æ¥è·å–ä½ç½®å’Œè®¡ç®—è·¯çº¿
4. **GPS ç²¾åº¦**ï¼šæˆ·å¤–ç¯å¢ƒä¸‹ GPS ç²¾åº¦æ›´é«˜

## æœªæ¥æ”¹è¿›å»ºè®®

1. **åº”ç”¨å†…å¯¼èˆª**ï¼šåœ¨åº”ç”¨å†…å®ç°å®Œæ•´çš„å¯¼èˆªä½“éªŒ
2. **ç¦»çº¿æ”¯æŒ**ï¼šæ”¯æŒç¦»çº¿åœ°å›¾å’Œå¯¼èˆª
3. **å¤šç§å¯¼èˆªé€‰é¡¹**ï¼šå…è®¸ç”¨æˆ·é€‰æ‹©ä¸åŒçš„åœ°å›¾åº”ç”¨
4. **å¯¼èˆªå†å²**ï¼šè®°å½•ç”¨æˆ·çš„å¯¼èˆªå†å²
5. **å®æ—¶ä½ç½®è¿½è¸ª**ï¼šåœ¨å¯¼èˆªè¿‡ç¨‹ä¸­å®æ—¶æ˜¾ç¤ºç”¨æˆ·ä½ç½®
6. **åˆ°è¾¾æé†’**ï¼šå¿«åˆ°è¾¾ç›®çš„åœ°æ—¶å‘é€é€šçŸ¥

## æ•…éšœæ’é™¤

### é—®é¢˜ï¼šç‚¹å‡»å¯¼èˆªæŒ‰é’®æ²¡æœ‰ååº”
**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥è®¾å¤‡æ˜¯å¦å®‰è£…äº†åœ°å›¾åº”ç”¨
- æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—æŸ¥æ‰¾é”™è¯¯ä¿¡æ¯
- ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

### é—®é¢˜ï¼šå¯¼èˆªæ‰“å¼€äº†é”™è¯¯çš„åº”ç”¨
**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥è®¾å¤‡çš„é»˜è®¤åœ°å›¾åº”ç”¨è®¾ç½®
- iOSï¼šè®¾ç½® > åœ°å›¾
- Androidï¼šè®¾ç½® > åº”ç”¨ > é»˜è®¤åº”ç”¨

### é—®é¢˜ï¼šæ— æ³•è·å–å½“å‰ä½ç½®
**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥ä½ç½®æƒé™æ˜¯å¦å·²æˆäºˆ
- ç¡®è®¤ GPS åŠŸèƒ½å·²å¼€å¯
- å°è¯•åœ¨æˆ·å¤–ä½¿ç”¨ä»¥è·å¾—æ›´å¥½çš„ GPS ä¿¡å·

## ç›¸å…³æ–‡ä»¶

- `apps/mobile/src/utils/navigation.ts` - å¯¼èˆªå·¥å…·å‡½æ•°
- `apps/mobile/src/components/break/MapModal.tsx` - åœ°å›¾æ¨¡æ€æ¡†ç»„ä»¶
- `apps/mobile/src/services/mapService.ts` - åœ°å›¾æœåŠ¡
- `apps/mobile/src/hooks/useMapIntegration.ts` - åœ°å›¾é›†æˆ Hook

## æŠ€æœ¯æ–‡æ¡£å‚è€ƒ

- [Apple Maps URL Scheme](https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/MapLinks/MapLinks.html)
- [Google Maps URLs](https://developers.google.com/maps/documentation/urls/android-intents)
- [React Native Linking](https://reactnative.dev/docs/linking)
- [Expo Location](https://docs.expo.dev/versions/latest/sdk/location/)

